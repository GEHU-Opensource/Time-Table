import pandas as pd

# Suppose your JSON-like data is stored in a variable called 'timetable'
timetable = {'Monday': {'D': [{'teacher_id': 'AK23', 'subject_id': 'CSP-501', 'classroom_id': 'R5', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'SP06', 'subject_id': 'TCS-503', 'classroom_id': 'R5', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'SJ16', 'subject_id': 'TCS-509', 'classroom_id': 'R5', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'DT20', 'subject_id': 'XCS-501', 'classroom_id': 'R5', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'C': [{'teacher_id': 'AB01', 'subject_id': 'TCS-531', 'classroom_id': 'R3', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'DP07', 'subject_id': 'TCS-503', 'classroom_id': 'R3', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'AP24', 'subject_id': 'SCS-501', 'classroom_id': 'R3', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'SS03', 'subject_id': 'TCS-502', 'classroom_id': 'R3', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'A': [{'teacher_id': 'AB01', 'subject_id': 'TCS-531', 'classroom_id': 'R2', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'HP18', 'subject_id': 'TMA-502', 'classroom_id': 'R2', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L1', 'time_slot': '11:10 - 12:05', 'group': 1}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L1', 'time_slot': '12:05 - 1:00', 'group': 1}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L2', 'time_slot': '11:10 - 12:05', 'group': 2}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L2', 'time_slot': '12:05 - 1:00', 'group': 2}, {'teacher_id': 'AA04', 'subject_id': 'TCS-502', 'classroom_id': 'R2', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'AC05', 'subject_id': 'TCS-503', 'classroom_id': 'R2', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'AK23', 'subject_id': 'CSP-501', 'classroom_id': 'R2', 'time_slot': '3:30 - 4:25', 'group': 'all'}], 'B': [{'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L1', 'time_slot': '9:00 - 9:55', 'group': 1}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L1', 'time_slot': '9:55 - 10:50', 'group': 1}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L2', 'time_slot': '9:00 - 9:55', 'group': 2}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L2', 'time_slot': '9:55 - 10:50', 'group': 2}, {'teacher_id': 'BJ10', 'subject_id': 'TMA-502', 'classroom_id': 'R4', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'BJ10', 'subject_id': 'TCS-503', 'classroom_id': 'R4', 'time_slot': '12:05 - 1:00', 'group': 'all'}, {'teacher_id': 'AP24', 'subject_id': 'SCS-501', 'classroom_id': 'R4', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'PK02', 'subject_id': 'TCS-531', 'classroom_id': 'R4', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'SS03', 'subject_id': 'TCS-502', 'classroom_id': 'R4', 'time_slot': '3:30 - 4:25', 'group': 'all'}]}, 'Tuesday': {'B': [{'teacher_id': 'BJ10', 'subject_id': 'TCS-503', 'classroom_id': 'R4', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'AB01', 'subject_id': 'TCS-531', 'classroom_id': 'R4', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'DT20', 'subject_id': 'XCS-501', 'classroom_id': 'R4', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'SS03', 'subject_id': 'TCS-502', 'classroom_id': 'R4', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'D': [{'teacher_id': 'SJ16', 'subject_id': 'TCS-509', 'classroom_id': 'R5', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'AA04', 'subject_id': 'TCS-502', 'classroom_id': 'R5', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'RS11', 'subject_id': 'PCS-503', 'classroom_id': 'L1', 'time_slot': '11:10 - 12:05', 'group': 1}, {'teacher_id': 'RS11', 'subject_id': 'PCS-503', 'classroom_id': 'L1', 'time_slot': '12:05 - 1:00', 'group': 1}, {'teacher_id': 'RS11', 'subject_id': 'PCS-503', 'classroom_id': 'L2', 'time_slot': '11:10 - 12:05', 'group': 2}, {'teacher_id': 'RS11', 'subject_id': 'PCS-503', 'classroom_id': 'L2', 'time_slot': '12:05 - 1:00', 'group': 2}], 'C': [{'teacher_id': 'JM12', 'subject_id': 'TMA-502', 'classroom_id': 'R3', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'AB17', 'subject_id': 'TCS-509', 'classroom_id': 'R3', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'PK02', 'subject_id': 'TCS-531', 'classroom_id': 'R3', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'AK23', 'subject_id': 'CSP-501', 'classroom_id': 'R3', 'time_slot': '12:05 - 1:00', 'group': 'all'}, {'teacher_id': 'SP06', 'subject_id': 'TCS-503', 'classroom_id': 'R3', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'PA21', 'subject_id': 'XCS-501', 'classroom_id': 'R3', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'AC05', 'subject_id': 'TCS-502', 'classroom_id': 'R3', 'time_slot': '3:30 - 4:25', 'group': 'all'}], 'A': [{'teacher_id': 'DP07', 'subject_id': 'PCS-503', 'classroom_id': 'L1', 'time_slot': '9:00 - 9:55', 'group': 1}, {'teacher_id': 'DP07', 'subject_id': 'PCS-503', 'classroom_id': 'L1', 'time_slot': '9:55 - 10:50', 'group': 1}, {'teacher_id': 'DP07', 'subject_id': 'PCS-503', 'classroom_id': 'L2', 'time_slot': '9:00 - 9:55', 'group': 2}, {'teacher_id': 'DP07', 'subject_id': 'PCS-503', 'classroom_id': 'L2', 'time_slot': '9:55 - 10:50', 'group': 2}, {'teacher_id': 'SS03', 'subject_id': 'TCS-502', 'classroom_id': 'R2', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'SP06', 'subject_id': 'TCS-503', 'classroom_id': 'R2', 'time_slot': '12:05 - 1:00', 'group': 'all'}, {'teacher_id': 'AB01', 'subject_id': 'TCS-531', 'classroom_id': 'R2', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'HP18', 'subject_id': 'TMA-502', 'classroom_id': 'R2', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'AP24', 'subject_id': 'SCS-501', 'classroom_id': 'R2', 'time_slot': '3:30 - 4:25', 'group': 'all'}]}, 'Wednesday': {'C': [{'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L1', 'time_slot': '9:00 - 9:55', 'group': 1}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L1', 'time_slot': '9:55 - 10:50', 'group': 1}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L2', 'time_slot': '9:00 - 9:55', 'group': 2}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L2', 'time_slot': '9:55 - 10:50', 'group': 2}, {'teacher_id': 'SJ16', 'subject_id': 'TCS-509', 'classroom_id': 'R3', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'SP06', 'subject_id': 'TCS-503', 'classroom_id': 'R3', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'A': [{'teacher_id': 'AB17', 'subject_id': 'TCS-509', 'classroom_id': 'R2', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'DP07', 'subject_id': 'TCS-503', 'classroom_id': 'R2', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L1', 'time_slot': '11:10 - 12:05', 'group': 1}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L1', 'time_slot': '12:05 - 1:00', 'group': 1}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L2', 'time_slot': '11:10 - 12:05', 'group': 2}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L2', 'time_slot': '12:05 - 1:00', 'group': 2}], 'B': [{'teacher_id': 'BJ10', 'subject_id': 'TCS-503', 'classroom_id': 'R4', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'SS03', 'subject_id': 'TCS-502', 'classroom_id': 'R4', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'RS11', 'subject_id': 'PCS-503', 'classroom_id': 'L3', 'time_slot': '11:10 - 12:05', 'group': 1}, {'teacher_id': 'RS11', 'subject_id': 'PCS-503', 'classroom_id': 'L3', 'time_slot': '12:05 - 1:00', 'group': 1}, {'teacher_id': 'RS11', 'subject_id': 'PCS-503', 'classroom_id': 'L4', 'time_slot': '11:10 - 12:05', 'group': 2}, {'teacher_id': 'RS11', 'subject_id': 'PCS-503', 'classroom_id': 'L4', 'time_slot': '12:05 - 1:00', 'group': 2}, {'teacher_id': 'HP18', 'subject_id': 'TCS-509', 'classroom_id': 'R4', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'DT20', 'subject_id': 'XCS-501', 'classroom_id': 'R4', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'AB01', 'subject_id': 'TCS-531', 'classroom_id': 'R4', 'time_slot': '3:30 - 4:25', 'group': 'all'}], 'D': [{'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L3', 'time_slot': '9:00 - 9:55', 'group': 1}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L3', 'time_slot': '9:55 - 10:50', 'group': 1}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L4', 'time_slot': '9:00 - 9:55', 'group': 2}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L4', 'time_slot': '9:55 - 10:50', 'group': 2}, {'teacher_id': 'SG19', 'subject_id': 'TCS-509', 'classroom_id': 'R5', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'JM12', 'subject_id': 'TMA-502', 'classroom_id': 'R5', 'time_slot': '12:05 - 1:00', 'group': 'all'}, {'teacher_id': 'PA21', 'subject_id': 'XCS-501', 'classroom_id': 'R5', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'AP24', 'subject_id': 'SCS-501', 'classroom_id': 'R5', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'PK02', 'subject_id': 'TCS-531', 'classroom_id': 'R5', 'time_slot': '3:30 - 4:25', 'group': 'all'}]}, 'Thursday': {'A': [{'teacher_id': 'SS03', 'subject_id': 'TCS-502', 'classroom_id': 'R2', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'SJ16', 'subject_id': 'TCS-509', 'classroom_id': 'R2', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'AB01', 'subject_id': 'TCS-531', 'classroom_id': 'R2', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'HP18', 'subject_id': 'TMA-502', 'classroom_id': 'R2', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'D': [{'teacher_id': 'AA04', 'subject_id': 'TCS-502', 'classroom_id': 'R5', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'SP06', 'subject_id': 'TCS-503', 'classroom_id': 'R5', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'PK02', 'subject_id': 'TCS-531', 'classroom_id': 'R5', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'BJ10', 'subject_id': 'TMA-502', 'classroom_id': 'R5', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'C': [{'teacher_id': 'AC05', 'subject_id': 'TCS-502', 'classroom_id': 'R3', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'AB17', 'subject_id': 'TCS-509', 'classroom_id': 'R3', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L1', 'time_slot': '11:10 - 12:05', 'group': 1}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L1', 'time_slot': '12:05 - 1:00', 'group': 1}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L2', 'time_slot': '11:10 - 12:05', 'group': 2}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L2', 'time_slot': '12:05 - 1:00', 'group': 2}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L1', 'time_slot': '1:20 - 2:15', 'group': 1}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L1', 'time_slot': '2:15 - 3:10', 'group': 1}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L2', 'time_slot': '1:20 - 2:15', 'group': 2}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L2', 'time_slot': '2:15 - 3:10', 'group': 2}, {'teacher_id': 'DT20', 'subject_id': 'XCS-501', 'classroom_id': 'R3', 'time_slot': '3:30 - 4:25', 'group': 'all'}], 'B': [{'teacher_id': 'AK23', 'subject_id': 'CSP-501', 'classroom_id': 'R4', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'SG19', 'subject_id': 'TCS-509', 'classroom_id': 'R4', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L3', 'time_slot': '11:10 - 12:05', 'group': 1}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L3', 'time_slot': '12:05 - 1:00', 'group': 1}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L4', 'time_slot': '11:10 - 12:05', 'group': 2}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L4', 'time_slot': '12:05 - 1:00', 'group': 2}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L3', 'time_slot': '1:20 - 2:15', 'group': 1}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L3', 'time_slot': '2:15 - 3:10', 'group': 1}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L4', 'time_slot': '1:20 - 2:15', 'group': 2}, {'teacher_id': 'AK26', 'subject_id': 'Placement_Class', 'classroom_id': 'L4', 'time_slot': '2:15 - 3:10', 'group': 2}, {'teacher_id': 'RS11', 'subject_id': 'TMA-502', 'classroom_id': 'R4', 'time_slot': '3:30 - 4:25', 'group': 'all'}]}, 'Friday': {'B': [{'teacher_id': 'BJ10', 'subject_id': 'TMA-502', 'classroom_id': 'R4', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'SJ16', 'subject_id': 'TCS-509', 'classroom_id': 'R4', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'D': [{'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L1', 'time_slot': '9:00 - 9:55', 'group': 1}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L1', 'time_slot': '9:55 - 10:50', 'group': 1}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L2', 'time_slot': '9:00 - 9:55', 'group': 2}, {'teacher_id': 'AD08', 'subject_id': 'PCS-506', 'classroom_id': 'L2', 'time_slot': '9:55 - 10:50', 'group': 2}, {'teacher_id': 'SP06', 'subject_id': 'TCS-503', 'classroom_id': 'R5', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'AB01', 'subject_id': 'TCS-531', 'classroom_id': 'R5', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'A': [{'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L3', 'time_slot': '9:00 - 9:55', 'group': 1}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L3', 'time_slot': '9:55 - 10:50', 'group': 1}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L4', 'time_slot': '9:00 - 9:55', 'group': 2}, {'teacher_id': 'PM14', 'subject_id': 'PMA-502', 'classroom_id': 'L4', 'time_slot': '9:55 - 10:50', 'group': 2}, {'teacher_id': 'DT20', 'subject_id': 'XCS-501', 'classroom_id': 'R2', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'AB17', 'subject_id': 'TCS-509', 'classroom_id': 'R2', 'time_slot': '12:05 - 1:00', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R2', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R2', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R2', 'time_slot': '3:30 - 4:25', 'group': 'all'}], 'C': [{'teacher_id': 'PK02', 'subject_id': 'TCS-531', 'classroom_id': 'R3', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'RS11', 'subject_id': 'TMA-502', 'classroom_id': 'R3', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'DP07', 'subject_id': 'PCS-503', 'classroom_id': 'L1', 'time_slot': '11:10 - 12:05', 'group': 1}, {'teacher_id': 'DP07', 'subject_id': 'PCS-503', 'classroom_id': 'L1', 'time_slot': '12:05 - 1:00', 'group': 1}, {'teacher_id': 'DP07', 'subject_id': 'PCS-503', 'classroom_id': 'L2', 'time_slot': '11:10 - 12:05', 'group': 2}, {'teacher_id': 'DP07', 'subject_id': 'PCS-503', 'classroom_id': 'L2', 'time_slot': '12:05 - 1:00', 'group': 2}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '3:30 - 4:25', 'group': 'all'}]}, 'Saturday': {'D': [{'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R5', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R5', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R5', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R5', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'A': [{'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R2', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R2', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R2', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R2', 'time_slot': '12:05 - 1:00', 'group': 'all'}], 'C': [{'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '12:05 - 1:00', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R3', 'time_slot': '3:30 - 4:25', 'group': 'all'}], 'B': [{'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '9:00 - 9:55', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '9:55 - 10:50', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '11:10 - 12:05', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '12:05 - 1:00', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '1:20 - 2:15', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '2:15 - 3:10', 'group': 'all'}, {'teacher_id': 'None', 'subject_id': 'Library', 'classroom_id': 'R4', 'time_slot': '3:30 - 4:25', 'group': 'all'}]}}

days_order = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]
time_order = [
    "9:00 - 9:55",
    "9:55 - 10:50",
    "11:10 - 12:05",
    "12:05 - 1:00",
    "1:20 - 2:15",
    "2:15 - 3:10",
    "3:30 - 4:25",
]


def get_section_table(timetable, section):
    rows = []
    for day, day_data in timetable.items():
        if section in day_data:
            for slot in day_data[section]:
                subj = slot["subject_id"]
                teacher = slot["teacher_id"]
                rows.append(
                    {
                        "Day": day,
                        "Time": slot["time_slot"],
                        "Subject": f"{subj} ({teacher})",
                    }
                )

    df = pd.DataFrame(rows)
    if df.empty:
        return pd.DataFrame()

    df["Day"] = pd.Categorical(df["Day"], categories=days_order, ordered=True)
    df["Time"] = pd.Categorical(df["Time"], categories=time_order, ordered=True)

    pivoted = (
        df.pivot_table(
            index="Day",
            columns="Time",
            values="Subject",
            aggfunc=lambda x: " / ".join(x)  # handle duplicate slots
        )
        .fillna("")
    )
    return pivoted


# List of sections to generate tables for.
sections = ["A", "B", "C", "D", "E", "F"]

# Create a single HTML string with all section timetables.
html_content = "<html><head><meta charset='utf-8'><title>All Sections Timetable</title></head><body>"
for section in sections:
    table = get_section_table(timetable, section)
    html_content += f"<h2>Section {section}</h2>"
    html_content += table.to_html()
html_content += "</body></html>"

# Write the combined HTML to a file.
with open("all_sections_timetable.html", "w", encoding="utf-8") as f:
    f.write(html_content)
